<template>
  <div class="main-view">
    <header class="header">
      <h1 class="title">RouteMate</h1>
      <p class="subtitle">–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ —Å–≤–æ–∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è –ª–µ–≥–∫–æ –∏ —É–¥–æ–±–Ω–æ</p>
    </header>

    <section class="search-section">
      <h2>–ü–æ–∏—Å–∫ –º–∞—Ä—à—Ä—É—Ç–∞</h2>
      <div class="input-group">
        <input
            v-model="fromCity"
            type="text"
            placeholder="üìç –û—Ç–∫—É–¥–∞ (–≥–æ—Ä–æ–¥ –∏–ª–∏ –∞–¥—Ä–µ—Å)"
            class="input"
        />
        <input
            v-model="toCity"
            type="text"
            placeholder="üèÅ –ö—É–¥–∞ (–≥–æ—Ä–æ–¥ –∏–ª–∏ –∞–¥—Ä–µ—Å)"
            class="input"
        />
        <button @click="findRoute" class="btn-search">
          –ù–∞–π—Ç–∏ –º–∞—Ä—à—Ä—É—Ç
          <span class="icon">‚Üí</span>
        </button>
      </div>
    </section>

    <section class="features">
      <h2>–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">üó∫Ô∏è</div>
          <h3>–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤</h3>
          <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏ –∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">‚è±Ô∏è</div>
          <h3>–†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏</h3>
          <p>–£–∑–Ω–∞–π—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ø—É—Ç–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon">‚ù§Ô∏è</div>
          <h3>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
          <p>–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ª—é–±–∏–º—ã–µ –º–µ—Å—Ç–∞ –∏ –º–∞—Ä—à—Ä—É—Ç—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞</p>
        </div>
      </div>
    </section>

    <section class="about">
      <h2>–û –ø—Ä–æ–µ–∫—Ç–µ</h2>
      <p>RouteMate - —ç—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç —Ç—É—Ä–∏—Å—Ç–∞–º –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–≤–æ–∏ –º–∞—Ä—à—Ä—É—Ç—ã. –ù–∞—à —Å–µ—Ä–≤–∏—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.</p>
      <p>–ù–∞—á–Ω–∏—Ç–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–µ —Å–ª–µ–¥—É—é—â–µ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</p>
    </section>

    <footer class="footer">
      <p>¬© 2025 RouteMate. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
      <div class="footer-links">
        <a href="#">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
        <a href="#">–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</a>
        <a href="#">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
      </div>
    </footer>

    <!-- Decorative background -->
    <div class="main-decoration">
      <div class="main-circle circle-1"></div>
      <div class="main-circle circle-2"></div>
    </div>
  </div>
</template>

<script setup>
// üõ† –ò–º–ø–æ—Ä—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π
import { ref } from 'vue'
import router from '@/router/router.js'
import axios from '/http-common.js' // –ø–æ–¥–∫–ª—é—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä axios

// üìå –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –≤–≤–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≥–æ—Ä–æ–¥–æ–≤
const fromCity = ref('')
const toCity = ref('')

// üîç –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∞
const findRoute = async () => {
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ–±–∞ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
  if (fromCity.value && toCity.value) {
    try {
      // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage
      const token = localStorage.getItem('token')

      // –ì–æ—Ç–æ–≤–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
      const config = {
        params: {
          startLocation: fromCity.value,
          endLocation: toCity.value
        }
      }

      // –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–æ–∫–µ–Ω ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
      if (token) {
        config.headers = {
          Authorization: `Bearer ${token}`
        }
      }

      // –í—ã–ø–æ–ª–Ω—è–µ–º GET-–∑–∞–ø—Ä–æ—Å –Ω–∞ –º–∞—Ä—à—Ä—É—Ç
      const response = await axios.get('/route/search', config)

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º –º–∞—Ä—à—Ä—É—Ç (–µ—Å–ª–∏ –æ–Ω –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞)
      const foundRoute = Array.isArray(response.data) ? response.data[0] : response.data

      if (foundRoute?.id) {
        // –ï—Å–ª–∏ –º–∞—Ä—à—Ä—É—Ç –Ω–∞–π–¥–µ–Ω ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –º–∞—Ä—à—Ä—É—Ç–∞
        await router.push({ name: 'RouteDetails', params: { routeId: foundRoute.id } })

        // –û—á–∏—â–∞–µ–º –ø–æ–ª—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞
        fromCity.value = ''
        toCity.value = ''
      } else {
        alert('–ú–∞—Ä—à—Ä—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.')
      }
    } catch (error) {
      // –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
      console.error(error)
      alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –º–∞—Ä—à—Ä—É—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.')
    }
  } else {
    // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –ø–æ–ª—è –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –æ–±–∞ –≥–æ—Ä–æ–¥–∞.')
  }
}
</script>


<style scoped>
.main-view {
  max-width: 1200px;
  padding: 2rem 1rem;
  display: flex;
  flex-direction: column;
  gap: 3rem;
  margin: 0 auto;
  position: relative;
  z-index: 1;
}

.header {
  text-align: center;
  padding: 2rem 0;
}

.title {
  font-size: 2.5rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  background: linear-gradient(90deg, #2563eb, #1d4ed8);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

.subtitle {
  font-size: 1.2rem;
  color: #374151;
  max-width: 600px;
  margin: 0 auto;
}

.search-section {
  background: #f9fafb;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  color: #1f2937;
}

.search-section h2 {
  text-align: center;
  margin-bottom: 1.5rem;
  font-size: 1.8rem;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  max-width: 500px;
  margin: 0 auto;
}

.input {
  padding: 0.8rem 1rem;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.input:focus {
  outline: none;
  border-color: #2563eb;
  box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
}

.btn-search {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  background-color: #2563eb;
  color: white;
  padding: 0.8rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  font-weight: 500;
  transition: all 0.3s ease;
  margin-top: 0.5rem;
}

.btn-search:hover {
  background-color: #1d4ed8;
  transform: translateY(-2px);
}

.icon {
  font-size: 1.2rem;
  transition: transform 0.3s ease;
}

.btn-search:hover .icon {
  transform: translateX(3px);
}

.features {
  margin-top: 2rem;
}

.features h2 {
  text-align: center;
  margin-bottom: 2rem;
  font-size: 1.8rem;
  color: #1f2937;
}

.features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
}

.feature-card {
  background: white;
  border-radius: 8px;
  padding: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
  transition: transform 0.3s ease;
  color: #1f2937;
}

.feature-card:hover {
  transform: translateY(-5px);
}

.feature-icon {
  font-size: 2rem;
  margin-bottom: 1rem;
}

.feature-card h3 {
  margin-bottom: 0.5rem;
  color: #1e40af;
}

.about {
  background: #f9fafb;
  padding: 2rem;
  border-radius: 12px;
  line-height: 1.6;
  color: #1f2937;
}

.about h2 {
  text-align: center;
  margin-bottom: 1.5rem;
  font-size: 1.8rem;
}

.footer {
  text-align: center;
  padding: 2rem 0;
  border-top: 1px solid #e5e7eb;
  margin-top: 2rem;
  color: #374151;
}

.footer-links {
  display: flex;
  justify-content: center;
  gap: 1rem;
  margin-top: 1rem;
}

.footer-links a {
  color: #4b5563;
  text-decoration: none;
  transition: color 0.3s ease;
}

.footer-links a:hover {
  color: #2563eb;
}

/* Decorative gradient background */
.main-decoration {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0;
  pointer-events: none;
  overflow: hidden;
}

.main-circle {
  position: absolute;
  border-radius: 50%;
  background: linear-gradient(135deg, #2563eb, #7c3aed);
  opacity: 0.08;
  filter: blur(60px);
}

.circle-1 {
  width: 400px;
  height: 400px;
  top: -100px;
  right: -100px;
}

.circle-2 {
  width: 500px;
  height: 500px;
  bottom: -200px;
  left: -150px;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

@media (max-width: 768px) {
  .title {
    font-size: 2rem;
  }

  .subtitle {
    font-size: 1rem;
  }

  .features-grid {
    grid-template-columns: 1fr;
  }

  .footer-links {
    flex-direction: column;
    gap: 0.5rem;
  }

  .main-decoration {
    display: none;
  }
}
</style>
